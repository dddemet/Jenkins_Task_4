#!/usr/bin/env groovy

pipeline {
	agent any
    stages {
        stage('BUILD') {
            steps{
                sh "docker build -t dddemet777/lab2 ."
            }
        }
        stage('TEST') {
			steps {
                sh "echo TEST"
            }
	  	}
        stage('PUSH') {
            steps{
	        	withCredentials([usernamePassword(credentialsId: 'DockerHub', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD')]) {
                    sh 'docker login -u $USERNAME -p $PASSWORD'
                    sh "docker push dddemet777/lab2" 
		        }
            }
        }
    }
}
